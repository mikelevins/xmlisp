<?xml version="1.0"?>
<behavior comments="I am user controlled">
  <method disclosed="true">
    <while-running/>
    <rule>
      <if>
        <once-every seconds="0.1"/>
      </if>
      <then>
        <message selector="Input">
          <direction/>
        </message>
        <message selector="Advance">
          <direction/>
        </message>
        <message selector="detectWin">
          <direction/>
        </message>
      </then>
    </rule>
    <rule>
      <if/>
      <then>
        <message selector="Input">
          <direction/>
        </message>
      </then>
    </rule>
  </method>
  <method disclosed="true">
    <when-creating-new-agent/>
    <rule>
      <if/>
      <then>
        <set attribute="DIR" value="0"/>
        <set attribute="P" value="10000"/>
        <set attribute="PLAYING" value="1"/>
      </then>
    </rule>
  </method>
  <method>
    <on selector="Input"/>
    <rule>
      <if>
        <key label="up arrow"/>
      </if>
      <then>
        <set attribute="DIR" value="0"/>
      </then>
    </rule>
    <rule>
      <if>
        <key label="left arrow"/>
      </if>
      <then>
        <set attribute="DIR" value="1"/>
      </then>
    </rule>
    <rule>
      <if>
        <key label="down arrow"/>
      </if>
      <then>
        <set attribute="DIR" value="2"/>
      </then>
    </rule>
    <rule>
      <if>
        <key label="right arrow"/>
      </if>
      <then>
        <set attribute="DIR" value="3"/>
      </then>
    </rule>
  </method>
  <method>
    <on selector="Advance"/>
    <rule>
      <if>
        <test expression1="DIR" expression2="0"/>
      </if>
      <then>
        <message selector="moveUp">
          <direction/>
        </message>
      </then>
    </rule>
    <rule>
      <if>
        <test expression1="DIR" expression2="1"/>
      </if>
      <then>
        <message selector="moveLeft">
          <direction/>
        </message>
      </then>
    </rule>
    <rule>
      <if>
        <test expression1="DIR" expression2="2"/>
      </if>
      <then>
        <message selector="moveDown">
          <direction/>
        </message>
      </then>
    </rule>
    <rule>
      <if>
        <test expression1="DIR" expression2="3"/>
      </if>
      <then>
        <message selector="moveRight">
          <direction/>
        </message>
      </then>
    </rule>
  </method>
  <method>
    <on selector="detectWin"/>
    <rule>
      <if>
        <test expression1="@enemynum" expression2="0"/>
      </if>
      <then>
        <play-sound ref="Wouhou.mp3"/>
        <set attribute="@ENEMYNUM" value="1"/>
        <stop-simulation/>
      </then>
    </rule>
  </method>
  <method>
    <on selector="moveUp"/>
    <rule>
      <if>
        <see shape="FLOOR Floor">
          <direction drow="1"/>
        </see>
      </if>
      <then>
        <move>
          <direction drow="1"/>
        </move>
        <rotate-to roll-angle="90"/>
        <new shape="WALL Wall">
          <direction drow="-1"/>
        </new>
        <message selector="colorBlue">
          <direction drow="-1"/>
        </message>
      </then>
    </rule>
    <rule>
      <if/>
      <then>
        <new shape="WALL Wall">
          <direction/>
        </new>
        <play-sound ref="Explode.mp3"/>
        <set attribute="@ENEMYNUM" value="1"/>
        <stop-simulation/>
      </then>
    </rule>
  </method>
  <method>
    <on selector="moveLeft"/>
    <rule>
      <if>
        <see shape="FLOOR Floor">
          <direction dcol="-1"/>
        </see>
      </if>
      <then>
        <move>
          <direction dcol="-1"/>
        </move>
        <rotate-to/>
        <new shape="WALL Wall">
          <direction dcol="1"/>
        </new>
        <message selector="colorBlue">
          <direction dcol="1"/>
        </message>
      </then>
    </rule>
    <rule>
      <if/>
      <then>
        <new shape="WALL Wall">
          <direction/>
        </new>
        <play-sound ref="Explode.mp3"/>
        <set attribute="@ENEMYNUM" value="1"/>
        <stop-simulation/>
      </then>
    </rule>
  </method>
  <method>
    <on selector="moveDown"/>
    <rule>
      <if>
        <see shape="FLOOR Floor">
          <direction drow="-1"/>
        </see>
      </if>
      <then>
        <move>
          <direction drow="-1"/>
        </move>
        <rotate-to roll-angle="-90"/>
        <new shape="WALL Wall">
          <direction drow="1"/>
        </new>
        <message selector="colorBlue">
          <direction drow="1"/>
        </message>
      </then>
    </rule>
    <rule>
      <if/>
      <then>
        <new shape="WALL Wall">
          <direction/>
        </new>
        <play-sound ref="Explode.mp3"/>
        <set attribute="@ENEMYNUM" value="1"/>
        <stop-simulation/>
      </then>
    </rule>
  </method>
  <method>
    <on selector="moveRight"/>
    <rule>
      <if>
        <see shape="FLOOR Floor">
          <direction dcol="1"/>
        </see>
      </if>
      <then>
        <move>
          <direction dcol="1"/>
        </move>
        <rotate-to roll-angle="180"/>
        <new shape="WALL Wall">
          <direction dcol="-1"/>
        </new>
        <message selector="colorBlue">
          <direction dcol="-1"/>
        </message>
      </then>
    </rule>
    <rule>
      <if/>
      <then>
        <new shape="WALL Wall">
          <direction/>
        </new>
        <play-sound ref="Explode.mp3"/>
        <set attribute="@ENEMYNUM" value="1"/>
        <stop-simulation/>
      </then>
    </rule>
  </method>
</behavior>